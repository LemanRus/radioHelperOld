#: import App kivy.app.App
#: import FadeTransition kivy.uix.screenmanager.FadeTransition

<RadioHelperScreenManager>:
    transition: FadeTransition()
    MainScreen:
        id: one
    NominalsScreen:
        id: nominal
    ResistorScreen:
        id: resistor
    CapacitorScreen:
    ComponentsScreen:
        id: components
    ResistorLEDCalculateScreen:
        id: LED_cal
    InductorCalculateScreen:
        id: inductor_cal
    ParallelResistorCalculateScreen:
        id: par_resistor_cal
    SerialCapacitorCalculateScreen:
        id: ser_capacitor_cal
    VoltageDividerCalculateScreen:
        id: divider_cal
    LM317CalculateScreen:
        id: lm317_cal
    PinsScreen:
    SchemesScreen:
    SymbolsScreen:
    StatesScreen:
    HelpScreen:
    AboutScreen:

<MainScreen>:
    name: "main"
    BoxLayout:
        orientation: "vertical"
        Label:
            id: title1
            text: "Помощник радиолюбителя"
            font_size: app.app_header_size
            size_hint_y: None
            height: 40
        BoxLayout:
            Button:
                id: nominals_button
                text: "Маркировка и номиналы компонентов"
                text_size: self.size
                halign: "center"
                valign: "center"
                font_size: app.app_button_size
                on_release: root.manager.current = "nominal"
            Button:
                id: button2
                text: "Расчёт компонентов для схем"
                text_size: self.size
                halign: "center"
                valign: "center"
                font_size: app.app_button_size
                on_release: root.manager.current = "components"
        BoxLayout:
            Button:
                id: button3
                text: "Распиновки"
                text_size: self.size
                halign: "center"
                valign: "center"
                font_size: app.app_button_size
                on_release: root.manager.current = "pins"
            Button:
                id: button4
                text: "Типовые схемы"
                text_size: self.size
                halign: "center"
                valign: "center"
                font_size: app.app_button_size
                on_release: root.manager.current = "schemes"
        BoxLayout:
            Button:
                id: button5
                text: "Обозначения компонентов на схемах"
                text_size: self.size
                halign: "center"
                valign: "center"
                font_size: app.app_button_size
                on_release: root.manager.current = "symbols"
            Button:
                text: "Полезные статьи"
                id: button6
                text_size: self.size
                halign: "center"
                valign: "center"
                font_size: app.app_button_size
                on_release: root.manager.current = "states"
        BoxLayout:
            Button:
                id: button7
                text: "Помощь"
                text_size: self.size
                halign: "center"
                valign: "center"
                font_size: app.app_button_size
                on_release: root.manager.current = "help"
            Button:
                id: button8
                text: "О программе"
                text_size: self.size
                halign: "center"
                valign: "center"
                font_size: app.app_button_size
                on_release: root.manager.current = "about"
        Button:
            id: button_set
            text: "Настройки"
            text_size: self.size
            halign: "center"
            valign: "center"
            font_size: app.app_button_size
            on_release: app.open_settings()

<MySpinnerOption>:
    font_size: app.app_button_size
    color: [0, 0, 0, 1] if self.text in ["white", "yellow", "gold", "silver"] else [1, 1, 1, 1]
    background_color: self.colors[self.text] if self.text in self.colors.keys() else [0.5, 0.5, 0.5, 1]
    background_normal: ""

<NominalsScreen>:
    name: "nominal"
    BoxLayout:
        orientation: "vertical"
        Button:
            text: "Резисторы"
            font_size: app.app_button_size
            on_release: root.manager.current = "resistor"
        Button:
            text: "Конденсаторы"
            font_size: app.app_button_size
            on_release: root.manager.current = "capacitor"
        Button:
            text: "На главный\nЗдесь будут расчёты компонентов"
            font_size: app.app_button_size
            on_release: root.manager.current = "main"

<ResistorScreen>:
    name: "resistor"
    BoxLayout:
        orientation: "vertical"
        BoxLayout:
            Label:
                text: "Для резисторов сквозного монтажа выберите количество полос:"
                text_size: self.size
                halign: "center"
                valign: "center"
                font_size: app.app_font_size
                size_hint_x: 2
            Spinner:
                id: main_spinner
                text: '3'
                font_size: app.app_button_size
                values: '3', '4', '5', '6'
                on_parent: root.build_resistor(self.text)
                on_text: root.build_resistor(self.text)
                option_cls: "MySpinnerOption"
        BoxLayout:
            canvas.before:
                Rectangle:
                    pos: self.pos
                    size: self.size
                    source: "./img/resistor.png"
            id: resistor_grid
            size_hint_y: 1.5
            Label:
                size_hint_x: 0.25
            BoxLayout:
                id: resistor_bands
                size_hint_y: 0.75
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            Label:
                size_hint_x: 0.25

        Button:
            text: "Рассчитать"
            font_size: app.app_button_size
            on_release: root.calculate_resistor(main_spinner.text)
        Label:
            id: resistance
            text: ""
            font_size: app.app_font_size
        Label:
            text: "Для SMD резистора впишите в поле ниже маркировку с резистора: "
            text_size: self.size
            halign: "center"
            valign: "center"
            font_size: app.app_font_size
            size_hint_y: 2
        BoxLayout:
            TextInput:
                id: smd_input
                font_size: app.app_font_size
                multiline: False
                halign: "center"
                padding_y: [self.height / 2.0 - (self.line_height / 2.0) * len(self._lines), 0]
                on_text_validate: root.calculate_smd_resistor(self.text)
            Button:
                text: "Рассчитать"
                size_hint_x: 0.2
                font_size: app.app_button_size
                on_release: root.calculate_smd_resistor(smd_input.text)
        Label:
            id: smd_resistance
        BoxLayout:
            Button:
                text: "Назад"
                font_size: app.app_button_size
                on_release: root.manager.current = "nominal"
            Button:
                text: "На главный"
                font_size: app.app_button_size
                on_release: root.manager.current = "main"

<CapacitorScreen>:
    name: "capacitor"
    BoxLayout:
        orientation: "vertical"
        Label:
            text: "Введите маркировку керамического конденсатора сквозного монтажа:"
            text_size: self.size
            font_size: app.app_font_size
            halign: "center"
            valign: "center"
        BoxLayout:
            TextInput:
                id: capacitor_input
                font_size: app.app_font_size
                multiline: False
                halign: "center"
                padding_y: [self.height / 2.0 - (self.line_height / 2.0) * len(self._lines), 0]
                on_text_validate: root.calculate_capacitor(self.text)
            Button:
                text: "Рассчитать"
                size_hint_x: 0.2
                font_size: app.app_button_size
                on_release: root.calculate_capacitor(capacitor_input.text)
        Label:
            id: capacity
            text_size: self.size
            font_size: app.app_font_size
            halign: "center"
            valign: "center"
        Label:
            text: "Введите маркировку SMD конденсатора:"
            font_size: app.app_font_size
            text_size: self.size
            halign: "center"
            valign: "center"
        BoxLayout:
            TextInput:
                id: smd_capacitor_input
                font_size: app.app_font_size
                multiline: False
                halign: "center"
                padding_y: [self.height / 2.0 - (self.line_height / 2.0) * len(self._lines), 0]
                on_text_validate: root.calculate_smd_capacitor(self.text)
            Button:
                text: "Рассчитать"
                font_size: app.app_button_size
                size_hint_x: 0.2
                on_release: root.calculate_smd_capacitor(smd_capacitor_input.text)
        Label:
            id: smd_capacity
            text_size: self.size
            font_size: app.app_font_size
            halign: "center"
            valign: "center"
        BoxLayout:
            Button:
                text: "Назад"
                font_size: app.app_button_size
                on_release: root.manager.current = "nominal"
            Button:
                text: "На главный"
                font_size: app.app_button_size
                on_release: root.manager.current = "main"

<ComponentsScreen>:
    name: "components"
    BoxLayout:
        orientation: "vertical"
        Label:
            text: "Расчёт компонентов"
        Button:
            text: "Расчёт резисторов для светодиодов"
            font_size: app.app_button_size
            on_release: root.manager.current = "LED_cal"
        Button:
            text: "Расчёт катушки индуктивности"
            font_size: app.app_button_size
            on_release: root.manager.current = "inductor_cal"
        Button:
            text: "Параллельное соединение резисторов"
            font_size: app.app_button_size
            on_release: root.manager.current = "par_resistor_cal"
        Button:
            text: "Последовательное соединение конденсаторов"
            font_size: app.app_button_size
            on_release: root.manager.current = "ser_capacitor_cal"
        Button:
            text: "Делитель напряжения"
            font_size: app.app_button_size
            on_release: root.manager.current = "divider_cal"
        Button:
            text: "LM317/LM350/LM338 калькулятор"
            font_size: app.app_button_size
            on_release: root.manager.current = "lm317_cal"
        Button:
            text: "На главный"
            font_size: app.app_button_size
            on_release: root.manager.current = "main"

<ResistorLEDCalculateScreen>:
#TODO: добавить функционал расчёта
    name: "LED_cal"
    BoxLayout:
        orientation: "vertical"
        BoxLayout:
            Label:
                text: "Напряжение источника питания:"
            TextInput:
                size_hint_x: 0.1
            Label:
                size_hint_x: 0.1
                text: "В"
        BoxLayout:
            Label:
                text: "Напряжение питания светодиода:"
            TextInput:
                size_hint_x: 0.1
            Label:
                size_hint_x: 0.1
                text: "В"
            Spinner:
                size_hint_x: 0.2
                text: '3'
                font_size: app.app_button_size
                values: '3', '4', '5', '6'
        BoxLayout:
            Label:
                text: "Ток светодиода:"
            TextInput:
                size_hint_x: 0.1
            Label:
                size_hint_x: 0.1
                text: "мА"
            Spinner:
                size_hint_x: 0.2
                text: '3'
                font_size: app.app_button_size
                values: '3', '4', '5', '6'
        BoxLayout:
            Label:
                text: "Количество светодиодов:"
            TextInput:
                size_hint_x: 0.1
            Label:
                size_hint_x: 0.1
                text: "шт"
        Label:
            canvas.before:
                Color:
                    rgba: 1,1,1,1
                Rectangle:
                    size: self.size
                    pos: self.pos
            size_hint_y: 0.05
        Label:
            text: "Результат:"
        BoxLayout:
            Label:
                text: "Расчётное сопротивление:"
            Label:
                canvas.before:
                    Color:
                        rgba: 1,1,1,1
                    Rectangle:
                        size: self.size
                        pos: self.pos
                size_hint_x: 0.1
            Label:
                size_hint_x: 0.1
                text: "Ом"
        BoxLayout:
            Label:
                text: "Стандартное значение:"
            Label:
                size_hint_x: 0.1
                canvas.before:
                    Color:
                        rgba: 1,1,1,1
                    Rectangle:
                        size: self.size
                        pos: self.pos
            Label:
                size_hint_x: 0.1
                text: "Ом"
        BoxLayout:
            Label:
                text: "Рассеиваемая на резисторе мощность:"
            Label:
                canvas.before:
                    Color:
                        rgba: 1,1,1,1
                    Rectangle:
                        size: self.size
                        pos: self.pos
                size_hint_x: 0.1
            Label:
                size_hint_x: 0.1
                text: "Вт"
        BoxLayout:
            Label:
                text: "Потребляемый ток:"
            Label:
                canvas.before:
                    Color:
                        rgba: 1,1,1,1
                    Rectangle:
                        size: self.size
                        pos: self.pos
                size_hint_x: 0.1
            Label:
                size_hint_x: 0.1
                text: "мА"
        BoxLayout:
            Button:
                text: "Назад"
                font_size: app.app_button_size
                on_release: root.manager.current = "components"
            Button:
                text: "На главный"
                font_size: app.app_button_size
                on_release: root.manager.current = "main"

<InductorCalculateScreen>:
    name: "inductor_cal"
    BoxLayout:
        Button:
            text: "Назад"
            font_size: app.app_button_size
            on_release: root.manager.current = "components"
        Button:
            text: "На главный"
            font_size: app.app_button_size
            on_release: root.manager.current = "main"

<ParallelResistorCalculateScreen>:
    name: "par_resistor_cal"
    BoxLayout:
        Button:
            text: "Назад"
            font_size: app.app_button_size
            on_release: root.manager.current = "components"
        Button:
            text: "На главный"
            font_size: app.app_button_size
            on_release: root.manager.current = "main"

<SerialCapacitorCalculateScreen>:
    name: "ser_capacitor_cal"
    BoxLayout:
        Button:
            text: "Назад"
            font_size: app.app_button_size
            on_release: root.manager.current = "components"
        Button:
            text: "На главный"
            font_size: app.app_button_size
            on_release: root.manager.current = "main"

<VoltageDividerCalculateScreen>:
    name: "divider_cal"
    BoxLayout:
        Button:
            text: "Назад"
            font_size: app.app_button_size
            on_release: root.manager.current = "components"
        Button:
            text: "На главный"
            font_size: app.app_button_size
            on_release: root.manager.current = "main"

<LM317CalculateScreen>:
    name: "lm317_cal"
    BoxLayout:
        Button:
            text: "Назад"
            font_size: app.app_button_size
            on_release: root.manager.current = "components"
        Button:
            text: "На главный"
            font_size: app.app_button_size
            on_release: root.manager.current = "main"

<PinsScreen>:
    name: "pins"
    BoxLayout:
        orientation: "vertical"
        ScrollView:
            id: scrlvw
            do_scroll_y: True
            size: self.size
            BoxLayout:
                orientation: "vertical"
                size_hint_y: None
                size_hint_x: 1
                height: self.minimum_height
                Label:
                    size_hint_y: None
                    text_size: self.width, None
                    height: self.texture_size[1]
                    font_size: app.app_font_size
                    text: "Тест распиновки:"
                Image:
                    source: "./img/resistor.png"
                    allow_stretch: True
                    keep_ratio: True
                    size_hint: None, None
                    width: root.width
                Label:
                    size_hint_y: None
                    text_size: self.width, None
                    height: self.texture_size[1]
                    font_size: app.app_font_size
                    text: "Тест распиновки:"
                Image:
                    source: "./img/resistor.png"
                    allow_stretch: True
                    keep_ratio: True
                    size_hint: None, None
                    width: root.width
                Label:
                    size_hint_y: None
                    text_size: self.width, None
                    height: self.texture_size[1]
                    font_size: app.app_font_size
                    text: "Тест распиновки:"
                Image:
                    source: "./img/resistor.png"
                    allow_stretch: True
                    keep_ratio: True
                    size_hint: None, None
                    width: root.width
        Button:
            text: "На главный\nЗдесь будут распиновки"
            font_size: app.app_button_size
            size_hint_y: 0.2
            on_release: root.manager.current = "main"

<SchemesScreen>:
    name: "schemes"
    BoxLayout:
        Button:
            text: "На главный\nЗдесь будут схемы"
            font_size: app.app_button_size
            on_release: root.manager.current = "main"

<SymbolsScreen>:
    name: "symbols"
    BoxLayout:
        Button:
            text: "На главный\nЗдесь будут обозначения"
            font_size: app.app_button_size
            on_release: root.manager.current = "main"

<StatesScreen>:
    name: "states"
    BoxLayout:
        Button:
            text: "На главный\nЗдесь будут статьи"
            font_size: app.app_button_size
            on_release: root.manager.current = "main"

<HelpScreen>:
    name: "help"
    BoxLayout:
        Button:
            text: "На главный\nЗдесь будет помощь"
            font_size: app.app_button_size
            on_release: root.manager.current = "main"

<AboutScreen>:
    name: "about"
    BoxLayout:
        Button:
            text: "На главный\nЗдесь будет 'о программе'"
            font_size: app.app_button_size
            on_release: root.manager.current = "main"
